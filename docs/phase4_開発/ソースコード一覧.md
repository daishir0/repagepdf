# ソースコード一覧

## 概要
RePage PDFシステムのソースコード一覧。バックエンド（Python/FastAPI）とフロントエンド（Next.js/TypeScript）で構成。

## ステータス
- **フェーズ**: 開発
- **作成日**: 2025-12-12
- **更新日**: 2025-12-16
- **作成者**: Claude (AIPM)
- **レビュー状況**: 完了

---

## サマリー

| 項目 | バックエンド | フロントエンド | 合計 |
|------|-------------|--------------|------|
| ファイル数 | 40 | 33 | 73 |
| 行数 | 約3,270行 | 約1,900行 | 約5,170行 |
| 言語 | Python | TypeScript/TSX | - |
| フレームワーク | FastAPI | Next.js 14 | - |

---

## バックエンド (`src/backend/`)

### ディレクトリ構成
```
src/backend/
├── app/
│   ├── api/           # APIエンドポイント
│   ├── converters/    # PDFコンバーター
│   ├── core/          # 設定・セキュリティ
│   ├── infrastructure/# DB・ファイルストレージ
│   ├── models/        # SQLAlchemyモデル
│   ├── schemas/       # Pydanticスキーマ
│   ├── services/      # ビジネスロジック
│   └── main.py        # エントリーポイント
├── requirements.txt
└── .env.example
```

### ファイル一覧

#### app/ (エントリーポイント)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `main.py` | 150 | FastAPIアプリケーション、ライフサイクル管理 |
| `__init__.py` | 1 | パッケージ初期化 |

#### app/core/ (コア機能)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `config.py` | 60 | アプリケーション設定（Pydantic Settings） |
| `security.py` | 100 | JWT認証、パスワードハッシュ、Fernet暗号化 |
| `exceptions.py` | 50 | カスタム例外クラス |
| `__init__.py` | 5 | エクスポート |

#### app/infrastructure/ (インフラ層)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `database.py` | 60 | SQLAlchemy設定、セッション管理 |
| `file_storage.py` | 80 | PDF・画像ファイル管理 |
| `__init__.py` | 3 | エクスポート |

#### app/models/ (データモデル)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `user.py` | 30 | Userモデル |
| `template.py` | 35 | Templateモデル |
| `conversion.py` | 50 | Conversion, ExtractedImageモデル |
| `settings.py` | 25 | UserSettingsモデル |
| `__init__.py` | 10 | エクスポート |

#### app/schemas/ (リクエスト/レスポンススキーマ)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `user.py` | 40 | ユーザー関連スキーマ |
| `template.py` | 35 | テンプレート関連スキーマ |
| `conversion.py` | 50 | 変換関連スキーマ |
| `settings.py` | 30 | 設定関連スキーマ |
| `common.py` | 25 | 共通スキーマ（ApiResponse等） |
| `__init__.py` | 10 | エクスポート |

#### app/converters/ (PDFコンバーター)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `base.py` | 80 | 抽象基底クラス（Strategy Pattern） |
| `pymupdf_converter.py` | 120 | PyMuPDF実装（高速） |
| `pdfplumber_converter.py` | 130 | pdfplumber実装（表に強い） |
| `openai_converter.py` | 150 | OpenAI Vision API実装 |
| `claude_converter.py` | 150 | Claude Vision API実装 |
| `manager.py` | 60 | コンバーター管理・切替 |
| `__init__.py` | 10 | エクスポート |

#### app/services/ (ビジネスロジック)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `auth_service.py` | 80 | 認証サービス |
| `template_service.py` | 120 | テンプレートCRUD |
| `conversion_service.py` | 200 | 変換処理サービス |
| `learning_service.py` | 180 | URL学習サービス（Playwright） |
| `settings_service.py` | 80 | 設定サービス |
| `__init__.py` | 10 | エクスポート |

#### app/api/ (APIエンドポイント)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `deps.py` | 40 | 依存性注入（認証等） |
| `auth.py` | 100 | 認証API（/api/auth/*） |
| `templates.py` | 150 | テンプレートAPI（/api/templates/*） |
| `conversions.py` | 180 | 変換API（/api/conversions/*） |
| `settings.py` | 100 | 設定API（/api/settings/*） |
| `__init__.py` | 20 | ルーター登録 |

---

## フロントエンド (`src/frontend/`)

### ディレクトリ構成
```
src/frontend/
├── src/
│   ├── app/           # Next.js App Router
│   ├── components/    # UIコンポーネント
│   ├── lib/           # ユーティリティ・API
│   ├── stores/        # Zustand状態管理
│   └── styles/        # グローバルCSS
├── package.json
├── tailwind.config.js
└── tsconfig.json
```

### ファイル一覧

#### src/app/ (ページ)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `layout.tsx` | 35 | ルートレイアウト |
| `page.tsx` | 30 | ホーム（リダイレクト） |
| `login/page.tsx` | 90 | ログインページ |
| `(main)/layout.tsx` | 15 | メインレイアウト |
| `(main)/templates/page.tsx` | 200 | テンプレート一覧 |
| `(main)/templates/[id]/page.tsx` | 280 | テンプレート詳細・変換 |
| `(main)/conversions/page.tsx` | 180 | 変換履歴一覧 |
| `(main)/settings/page.tsx` | 220 | 設定ページ |

#### src/components/ui/ (UIコンポーネント)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `Button.tsx` | 65 | ボタンコンポーネント |
| `Input.tsx` | 45 | 入力フィールド |
| `Select.tsx` | 50 | セレクトボックス |
| `Card.tsx` | 60 | カードコンポーネント |
| `Modal.tsx` | 70 | モーダルダイアログ |
| `Badge.tsx` | 50 | バッジ・ステータス表示 |
| `Spinner.tsx` | 40 | ローディング表示 |
| `EmptyState.tsx` | 30 | 空状態表示 |
| `ConfirmDialog.tsx` | 50 | 確認ダイアログ |
| `index.ts` | 20 | エクスポート |

#### src/components/layout/ (レイアウト)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `Header.tsx` | 50 | ヘッダー |
| `Sidebar.tsx` | 55 | サイドバー |
| `MainLayout.tsx` | 45 | メインレイアウト |
| `index.ts` | 5 | エクスポート |

#### src/components/ (その他)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `FileDropzone.tsx` | 80 | ファイルドロップゾーン |
| `index.ts` | 5 | エクスポート |

#### src/lib/ (ユーティリティ)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `api.ts` | 150 | Axios APIクライアント |
| `types.ts` | 130 | 型定義 |
| `utils.ts` | 60 | ユーティリティ関数 |

#### src/stores/ (状態管理)
| ファイル | 行数 | 説明 |
|---------|------|------|
| `authStore.ts` | 70 | 認証状態 |
| `templateStore.ts` | 100 | テンプレート状態 |
| `conversionStore.ts` | 100 | 変換状態 |
| `settingsStore.ts` | 70 | 設定状態 |
| `index.ts` | 5 | エクスポート |

#### src/styles/
| ファイル | 行数 | 説明 |
|---------|------|------|
| `globals.css` | 80 | Tailwind CSS + カスタムスタイル |

---

## 設定ファイル

### バックエンド
| ファイル | 説明 |
|---------|------|
| `requirements.txt` | Python依存関係 |
| `.env.example` | 環境変数サンプル |

### フロントエンド
| ファイル | 説明 |
|---------|------|
| `package.json` | Node.js依存関係 |
| `tsconfig.json` | TypeScript設定 |
| `tailwind.config.js` | Tailwind CSS設定 |
| `postcss.config.js` | PostCSS設定 |
| `next.config.js` | Next.js設定 |

---

## 変更履歴
| 日付 | 版 | 変更内容 | 変更者 |
|------|-----|----------|--------|
| 2025-12-12 | 1.0 | 初版作成 | Claude (AIPM) |
| 2025-12-16 | 1.1 | 実装完了に伴い内容記載 | Claude (AIPM) |

---

## AIレビュー結果
- レビュー日: 2025-12-16
- レビュアー: Claude (AIPM)
- 結果: **適切**
- コメント: バックエンド/フロントエンドともにレイヤードアーキテクチャで整理されており、責務分離が適切。コンバーターのStrategy Pattern採用により拡張性も確保されている。
